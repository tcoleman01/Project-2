<!doctype html>
<html lang="en">
  <head>
<script>
  // Only redirect if no session is set
  try {
    const s = JSON.parse(localStorage.getItem('vg_session') || 'null');
    if (!s || !s.email) {
      window.location.replace('index.html'); // login page
    }
  } catch (e) {
    window.location.replace('index.html');
  }
</script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="./css/main.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>Dashboard</h1>
      </header>
    </div>

    <!-- Quick links to demo pages (add-only) -->
    <nav class="container my-3">
      <div class="btn-group flex-wrap" role="group" aria-label="Theresa demo links">
        <a class="btn btn-outline-primary btn-sm" href="./signup.html">Sign Up</a>
        <a class="btn btn-outline-primary btn-sm" href="./index.html">Log In</a>
        <a class="btn btn-outline-secondary btn-sm" href="./account.html">My Account</a>
        <a class="btn btn-outline-secondary btn-sm" href="./user-profile.html">Dashboard</a>
        <a class="btn btn-outline-secondary btn-sm" href="./game.html">Games</a>
      </div>
    </nav>

    <!--User stats container-->
    <div class="container" id="user-stats">
      <h2>Stats. Yours to be exact.</h2>
      <div class="row">
        <div class="col-md-3 stat-card">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title" id="total-games"></h5>
              <p class="card-text">Total # of games</p>
            </div>
          </div>
        </div>
        <div class="col-md-3 stat-card">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title" id="completed-games"></h5>
              <p class="card-text">Completed</p>
            </div>
          </div>
        </div>
        <div class="col-md-3 stat-card">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title" id="hours-logged"></h5>
              <p class="card-text">Hours Logged</p>
            </div>
          </div>
        </div>
        <div class="col-md-3 stat-card">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title" id="total-spent"></h5>
              <p class="card-text">Total Spent</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!--Container for personal game catalogue-->
    <div class="container py-4" id="personal-catalogue">
      <div class="row">
        <div class="col-lg-12">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h2 class="section-header mb-5">The Goods</h2>
            <div class="d-flex gap-2 mb-4">
              <button type="button" class="btn btn-outline-secondary mb-4" data-bs-toggle="offcanvas" data-bs-target="#filter-offcanvas">Filters</button>
              <button type="button" class="btn btn-primary mb-4" data-bs-toggle="modal" data-bs-target="#add-game-modal" id="add-game-btn">Add New Game</button>
            </div>
          </div>
          <div class="row game-grid align-items-center" id="game-section">
            <!-- Game cards will be dynamically inserted here -->
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-12">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h2 class="section-header mb-5">The Reviews</h2>
            <div class="d-flex gap-2 mb-4">
              <button class="btn btn-primary mb-4" data-bs-toggle="modal" data-bs-target="#add-review-modal" id="add-review-btn">Add New Review</button>
            </div>
          </div>
          <div class="review-div" id="review-section">
            <!-- Review cards will be dynamically inserted here -->
          </div>
        </div>
      </div>
    </div>

    <!-- Add Game Modal -->
    <!-- Current input is title, genre, platform, status, hours logged, and price-->
    <div class="modal fade" id="add-game-modal" tabindex="-1" aria-labelledby="add-game-modal-label" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="add-game-modal-label">Add a New Game</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="new-game-form"> <!-- Form Id for adding a new game -->
              <div class="mb-3 position-relative">
                <label for="game-title" class="form-label">Game Title</label>
                <input type="text" class="form-control" id="game-title" required />
                <input type="hidden" id="game-id" />
                <ul id="suggestions"></ul>
              </div>
              <div class="mb-3">
                <label for="game-genre" class="form-label">Genre</label>
                <select class="form-select" id="game-genre">
                  <option>Action</option>
                  <option>Adventure</option>
                  <option>RPG</option>
                  <option>Action RPG</option>
                  <option>Metroidvania</option>
                  <option>Strategy</option>
                  <option>Fighting</option>
                  <option>FPS</option>
                  <option>Platformer</option>
                  <option>Puzzle</option>
                  <option>Racing</option>
                  <option>MMORPG</option>
                  <option>Sandbox</option>
                  <option>Survival</option>
                  <option>Roguelike</option>
                  <option>Horror</option>
                  <option>Sports</option>
                  <option>Simulation</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="game-platform" class="form-label">Platform</label>
                <select class="form-select" id="game-platform">
                  <option>PC</option>
                  <option>PlayStation 5</option>
                  <option>PlayStation 4</option>
                  <option>PlayStation 3</option>
                  <option>PlayStation 2</option>
                  <option>PlayStation</option>
                  <option>PlayStation Vita</option>
                  <option>Xbox Series X</option>
                  <option>Xbox One</option>
                  <option>Xbox 360</option>
                  <option>Nintendo Switch</option>
                  <option>Nintendo Wii U</option>
                  <option>Nintendo Wii</option>
                  <option>Nintendo GameCube</option>
                  <option>Nintendo 64</option>
                  <option>SNES</option>
                  <option>Nintendo 3DS</option>
                  <option>Nintendo DS</option>
                  <option>Game Boy Advance SP</option>
                  <option>Game Boy Advance</option>
                  <option>Game Boy Color</option>
                  <option>Game Boy</option>
                  <option>Mobile</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="game-status" class="form-label">Status</label>
                <select class="form-select" id="game-status">
                  <option value="Playing" selected>Playing</option>
                  <option value="Completed">Completed</option>
                  <option value="Backlog">Backlog</option>
                  <option value="Wishlist">Wishlist</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="game-hours" class="form-label">Hours Logged</label>
                <input type="number" class="form-control" id="game-hours" min="0" value="0" />
              </div>
              <div class="mb-3">
                <label for="game-price" class="form-label">Price</label>
                <input type="number" class="form-control" id="game-price" min="0" step="0.01" value="0" />
              </div>        
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-success" id="submit-add-game">Submit</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Game Modal -->
    <div class="modal fade" id="edit-game-modal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit Game</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="edit-game-form"> <!-- Form Id for editing a game -->
              <div class="mb-3">
                <label class="form-label">Status</label>
                <select id="edit-status" class="form-select">
                  <option>Playing</option>
                  <option>Completed</option>
                  <option>Backlog</option>
                  <option>Wishlist</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Hours Played</label>
                <input id="edit-hours" type="number" min="0" class="form-control">
              </div>
              <div class="mb-3">
                <label class="form-label">Price Paid</label>
                <input id="edit-price" type="number" min="0" step="0.01" class="form-control">
                <input type="hidden" id="edit-game-id" />
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" id="save-edit-btn" class="btn btn-primary">Save</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Review Modal -->
     <div class="modal fade" id="add-review-modal" tabindex="-1" aria-labelledby="add-review-modal-label" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="add-review-modal-label">Add a New Review</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="new-review-form"> <!-- Form Id for adding a new review -->
              <div class="mb-3 position-relative">
                <label for="review-game-title" class="form-label">Game Title</label>
                <input type="text" class="form-control" id="review-game-title" required />
                <input type="hidden" id="review-game-id" />
                <ul id="review-suggestions"></ul>
              </div>
              <div class="mb-3">
                <label for="review-text" class="form-label">Review</label>
                <textarea class="form-control" id="review-text" rows="3" required></textarea>
              </div>
              <div class="mb-3">
                <label for="review-rating" class="form-label">Rating</label>
                <select class="form-select" id="review-rating" required>
                  <option value="">Select a rating</option>
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5</option>
                </select>
              </div>
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-primary">Submit Review</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Review Modal -->
    <div class="modal fade" id="edit-review-modal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit Review</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="edit-review-form"> <!-- Form Id for editing a review -->
              <div class="mb-3">
                <label class="form-label">Review Text</label>
                <textarea id="edit-review-text" class="form-control" rows="3"></textarea>
              </div>
              <div class="mb-3">
                <label class="form-label">Rating</label>
                <select id="edit-review-rating" class="form-select">
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5</option>
                </select>
                <input type="hidden" id="edit-review-id" />
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" id="save-review-edit-btn" class="btn btn-primary">Save</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Offcanvas Filters -->
    <div class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="filter-offcanvas">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Filters</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <div class="filter-section">
          <label>Search</label>
          <input type="text" class="form-control" id="search-filter" placeholder="Search your games..." />
        </div>
        <div class="filter-section">
          <label>Status</label>
          <select class="form-select" id="status-filter">
            <option selected>All Statuses</option>
            <option>Completed</option>
            <option>Playing</option>
            <option>Backlog</option>
            <option>Wishlist</option>
          </select>
        </div>
        <div class="filter-section">
          <label>Genre</label>
          <select class="form-select" id="genre-filter">
            <option selected>All Genres</option>
            <option>Action</option>
            <option>Adventure</option>
            <option>RPG</option>
            <option>Action RPG</option>
            <option>Metroidvania</option>
            <option>Strategy</option>
            <option>Fighting</option>
            <option>FPS</option>
            <option>Platformer</option>
            <option>Puzzle</option>
            <option>Racing</option>
            <option>MMORPG</option>
            <option>Sandbox</option>
            <option>Survival</option>
            <option>Roguelike</option>
            <option>Horror</option>
            <option>Sports</option>
            <option>Simulation</option>
          </select>
        </div>
        <div class="filter-section">
          <label>Platform</label>
          <select class="form-select" id="platform-filter">
            <option selected>All Platforms</option>
            <option>PC</option>
            <option>PlayStation 5</option>
            <option>PlayStation 4</option>
            <option>PlayStation 3</option>
            <option>PlayStation 2</option>
            <option>PlayStation</option>
            <option>PlayStation Vita</option>
            <option>Xbox Series X</option>
            <option>Xbox One</option>
            <option>Xbox 360</option>
            <option>Nintendo Switch</option>
            <option>Nintendo Wii U</option>
            <option>Nintendo Wii</option>
            <option>Nintendo GameCube</option>
            <option>Nintendo 64</option>
            <option>SNES</option>
            <option>Nintendo 3DS</option>
            <option>Nintendo DS</option>
            <option>Game Boy Advance SP</option>
            <option>Game Boy Advance</option>
            <option>Game Boy Color</option>
            <option>Game Boy</option>
            <option>Mobile</option>
          </select>
        </div>
        <div class="filter-section">
          <label>Sort By</label>
          <select class="form-select" id="sort-filter">
            <option selected>Title (A-Z)</option>
            <option>Title (Z-A)</option>
            <option>Release Date (Newest)</option>
            <option>Release Date (Oldest)</option>
            <option>Hours Played (High to Low)</option>
            <option>Hours Played (Low to High)</option>
            <option>Price (High to Low)</option>
            <option>Price (Low to High)</option>
          </select>
        </div>
        <button class="btn btn-reset mt-3 w-100" id="reset-filters">Reset All Filters</button>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
      crossorigin="anonymous"
    ></script>
    <script src="./js/user-profile.js"></script>
  </body>
</html>